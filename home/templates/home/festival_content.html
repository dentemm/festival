{% load rating_tags static comments wagtailuserbar wagtailcore_tags wagtailimages_tags %}

<div id="current_item" style="display: none;">{{ festival.pk }}</div>
<div class="container">
    <div class="row">
        <div class="col-md-12 fa_heading">
            <a href="{% pageurl festival %}" style="text-decoration:none;">
                <h1>{{ festival.name }}</h1>
            </a>
            <div class="col-md-12">
                <i class="fa fa-star fa-2x"></i>
                <i class="fa fa-star fa-2x"></i>
                <i class="fa fa-star fa-2x"></i>
                <i class="fa fa-star fa-2x"></i>
                <i class="fa fa-star-o fa-2x"></i>
            </div>
        </div>
    </div>
    <div class="row">
        <div class="col-md-7 fa_overlay">
            <h4>{{ festival.description|safe }}</h4>
        </div>
        <div class="col-md-4 col-md-offset-1 fa_tickets">
            <a href="{{ festival.website }}">
                <button type="button" class="btn btn-success">Koop Tickets</button>
            </a>
            <a href="#"><i class="fa fa-internet-explorer" aria-hidden="true"></i> Website</a>  |
            <a href="#"><i class="fa fa-facebook-official" aria-hidden="true"></i> Facebook</a>  |
            <a href="#"><i class="fa fa-youtube-square" aria-hidden="true"></i> Youtube</a><br>
        </div>
    </div>
    <div class="row">
        <div class="fa_calendar_item">
            <div class="row">
                <div class="col-md-6 fa_overlay2">
                    <div id="fa_carousel" class="carousel slide" data-ride="carousel">
                        <!-- Wrapper for slides -->
                        <div class="carousel-inner" role="listbox">
                            <div class="item active">
                                {% image festival.main_image fill-600x345 as img %}
                                <img src="{{ img.url }}" class="img-responsive img-thumbnail">
                                <!--<div class="carousel-caption">
                                    &copy Joris Claes<br>Werchter 2015
                                </div>-->
                            </div>
                        </div>
                    </div>
                </div> 
                <div class="col-md-2 fa_overlay2 hidden-xs">
                    <div class="col-md-12 fa_thumbs">
                        {% for image in festival.images.all|slice:':3' %}
                            {% if image %}
                                {% image image.image fill-600x345 as img %}
                                <img src="{{ img.url }}" class="img-responsive img-thumbnail">
                            {% endif %}
                        {% endfor %}
                    </div>
                </div>
                <div class="col-md-4 fa_overlay hidden-xs">
                    <div id="map" class="img-thumbnail" style="height:250px">
                        
                    </div>
                    <h5>
                        <i class="fa fa-map-marker" aria-hidden="true"></i> 
                        Festivalpark Werchter | Haachtsesteenweg, 3118 Werchter
                    </h5>
                </div>
            </div>
            <div class="row">      
                <div class="col-md-4 fa_action">
                    <a href="{% pageurl festival %}">
                    <button type="button" class="btn btn-success">
                        Meer informatie
                    </button>
                    </a>
                </div>
                <div class="col-md-4 fa_action text-center">
                    <h5>
                        Al <a href="#">35</a> beoordelingen van onze FestivalAdvisors
                    </h5>
                </div>
                <div class="col-md-4 fa_action">
                    <button type="button" class="btn btn-success">Schrijf een beoordeling</button>
                </div>
            </div>
        </div>
    </div>
</div>

<script type="text/javascript" src="https://maps.googleapis.com/maps/api/js?v=3&language=nl&region=BE"></script>
<script type="text/javascript">
    var map;
    var infowindow = new google.maps.InfoWindow({});

    function initialize() {


        var styles = [{"featureType": "all","elementType": "all","stylers": [{"hue": "#ff5a00"},{"saturation": "22"},
            {"lightness": "-1"},{"gamma": "1.00"}]},{"featureType": "road","elementType": "labels.icon","stylers": [
            {"visibility": "off"}]},{"featureType": "road.highway","elementType": "all","stylers": [{"color": "#ff8b0b"}]},
            {"featureType": "road.highway","elementType": "geometry.stroke","stylers": [{"visibility": "off"}]},
            {"featureType": "road.arterial","elementType": "all","stylers": [{"color": "#ff8b0b"}]},{"featureType":     
            "road.arterial","elementType": "geometry.stroke","stylers": [{"visibility": "off"}]},{
            "featureType": "road.arterial","elementType": "labels.text.fill","stylers": [{"color": "#ffffff"}]},
            {"featureType": "road.arterial","elementType": "labels.text.stroke","stylers": [{"color": "#ff8b0b"}, 
            {"weight": "3.73"}]},{"featureType": "road.arterial","elementType": "labels.icon","stylers": [
            {"saturation": "-100"},{"lightness": "6"},{"gamma": "2.44"},{"hue": "#ff0000"},{"weight": "3.34"},
            {"visibility": "off"}]},{"featureType": "road.local","elementType": "geometry.fill","stylers": [
            {"color": "#ddccc2"}]},{"featureType": "road.local","elementType": "geometry.stroke","stylers": [
            {"color": "#f5f0eb"},{"lightness": "24"},{"saturation": "39"},{"weight": "0.74"}
            ]},{"featureType": "road.local","elementType": "labels.text.stroke","stylers": [{"weight": "3.60"},
            {"color": "#ffffff"}]},{"featureType": "water","elementType": "all","stylers": [{"color": "#39c1bf"}]},
            {"featureType": "water","elementType": "labels.text.fill","stylers": [{"color": "#ffffff"}]},
            {"featureType": "water","elementType": "labels.text.stroke","stylers": [{"color": "#39c1bf"}]}];

        var styledMap = new google.maps.StyledMapType(styles, {name: 'FestivalMap'});


        geocoder = new google.maps.Geocoder();
        var latlng = new google.maps.LatLng({{ festival.location.latitude|stringformat:'f' }}, {{ festival.location.longitude|stringformat:'f' }}); 
        var myOptions = {
            zoom: 8,
            center: latlng,
            scrollwheel: false,
            mapTypeControlOptions: {
                mapTypeIds: [google.maps.MapTypeId.ROADMAP, 'map_style']
            }

            //mapTypeId: google.maps.MapTypeId.ROADMAP
        }
        map = new google.maps.Map(document.getElementById("map"), myOptions);
         
        map.mapTypes.set('map_style', styledMap);
        map.setMapTypeId('map_style');

        addMarker();  
    }

    function addMarker() {
        var lat = parseFloat({{ festival.location.latitude|stringformat:'f' }});
        var lng = parseFloat({{ festival.location.longitude|stringformat:'f' }});
        var name = '{{ festival.name|title }}';
        var url = '{% pageurl festival %}';

        var myLatlng = new google.maps.LatLng(lat, lng);

        var contentString = '<div><h6>' + name + '</h6><a href="' + url  + '">Meer details</a></div>'

        var marker = new google.maps.Marker({
            position: myLatlng,
            map: map,
            //title: "Coordinates: " + lat + " , " + lng + " | Trailhead name: " + trailhead_name
            title: name
        });

        marker['infowindow'] = contentString;

        google.maps.event.addListener(marker, 'click', function() {
            infowindow.setContent(this['infowindow']);
            infowindow.open(map, this);
        });
    }

    //window.onload = initialize;

    google.maps.event.addDomListener(window, 'load', initialize);
</script>


